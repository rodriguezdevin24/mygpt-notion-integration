
{
  "type": "object",
  "required": ["name", "properties"],
  "properties": {
    "name": { 
      "type": "string", 
      "minLength": 1,
      "description": "Database name"
    },
    "properties": {
      "type": "object",
      "description": "Database properties/columns",
      "patternProperties": {
        "^.+$": {
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "enum": [
                "title",
                "rich_text",
                "number",
                "select",
                "multi_select",
                "date",
                "checkbox",
                "relation",
                "formula",
                "rollup",
                "url",
                "email",
                "phone_number",
                "files",
                "people",
                "created_time",
                "last_edited_time",
                "created_by",
                "last_edited_by"
              ],
              "description": "Property type"
            },
            "options": {
              "type": "array",
              "items": {
                "oneOf": [
                  { "type": "string" },
                  {
                    "type": "object",
                    "required": ["name"],
                    "properties": {
                      "name": { "type": "string" },
                      "color": { "type": "string" }
                    }
                  }
                ]
              },
              "description": "Options for select/multi_select"
            },
            "relation": {
              "type": "object",
              "required": ["database_id"],
              "properties": {
                "database_id": { 
                  "type": "string", 
                  "minLength": 1,
                  "description": "Related database ID"
                },
                "synced_property_name": {
                  "type": "string",
                  "description": "For two-way relations, the property name in the related database"
                }
              },
              "additionalProperties": false,
              "description": "Relation configuration"
            },
            "rollup": {
              "type": "object",
              "required": ["relation_property_name", "rollup_property_name", "function"],
              "properties": {
                "relation_property_name": {
                  "type": "string",
                  "description": "Name of the relation property to follow"
                },
                "rollup_property_name": {
                  "type": "string",
                  "description": "Name of the property in the related database to aggregate"
                },
                "function": {
                  "enum": [
                    "count",
                    "count_values",
                    "empty",
                    "not_empty",
                    "unique",
                    "show_unique",
                    "percent_empty",
                    "percent_not_empty",
                    "sum",
                    "average",
                    "median",
                    "min",
                    "max",
                    "range",
                    "show_original"
                  ],
                  "description": "Aggregation function"
                }
              },
              "additionalProperties": false,
              "description": "Rollup configuration"
            },
            "expression": {
              "type": "string",
              "description": "Formula expression (e.g., 'prop(\"Price\") * prop(\"Quantity\")')"
            },
            "format": { 
              "type": "string",
              "enum": ["number", "dollar", "percent", "euro", "pound", "yen", "rupee", "won", "yuan"],
              "description": "Number format"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "icon": { 
      "type": "object",
      "description": "Database icon configuration"
    },
    "cover": { 
      "type": "object",
      "description": "Database cover image configuration"
    }
  },
  "additionalProperties": false
}